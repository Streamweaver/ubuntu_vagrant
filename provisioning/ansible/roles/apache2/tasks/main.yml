---
- apt: pkg=apache2 state=installed
  when: ansible_os_family == 'Debian'

- yum: name=httpd state=installed
  when: ansible_os_family == 'RedHat'

- name: CONFIG | generate apache site config
  template:
    src: vhost.config.j2
    dest: "/etc/apache2/sites-available/{{ a2_siteconfig }}.conf"
    mode: 0644

- name: CONFIG | Deactivate default site
  sudo: yes
  command: "a2dissite 000-default"

- name: CONFIG | Activate wordpress site
  sudo: yes
  command: "a2ensite {{ a2_siteconfig }}"
  notify: restart apache

- name: Apache | Enable modules
  apache2_module: name={{ item }} state=present
  tags: apache2
  when: ansible_os_family == 'Debian' and a2modules_active
  with_items: "{{ a2modules_active }}"
  notify:
    - restart apache

- name: Apache | Disable modules
  apache2_module: name={{ item }} state=absent
  tags: apache2
  when: ansible_os_family == 'Debian' a2modules_inactive
  with_items: "{{ a2modules_inactive }}"
  notify:
    - restart apache
